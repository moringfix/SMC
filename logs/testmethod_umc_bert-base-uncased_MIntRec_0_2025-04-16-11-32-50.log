2025-04-16 11:32:50,364 - 【半监督】进入了半监督的设定中, 随机抽取标签
2025-04-16 11:32:50,364 - The number of known intents is 5
2025-04-16 11:32:50,364 - Lists of known labels are: [np.str_('Greet'), np.str_('Praise'), np.str_('Ask for help'), np.str_('Joke'), np.str_('Comfort')]
2025-04-16 11:32:50,372 - Number of labeled training samples = 28
2025-04-16 11:32:50,372 - Number of unlabeled training samples = 1306
2025-04-16 11:32:50,372 - Number of evaluation samples = 93
2025-04-16 11:32:50,372 - Number of testing samples = 445
2025-04-16 11:32:50,372 - data preparation...
2025-04-16 11:32:52,038 - data preparation...
2025-04-16 11:33:04,287 - data preparation...
2025-04-16 11:33:05,588 - data preparation...
2025-04-16 11:33:07,953 - num_train_examples = 1334
2025-04-16 11:33:07,954 - ============================== Params ==============================
2025-04-16 11:33:07,954 - logger_name: testmethod_umc_bert-base-uncased_MIntRec_0
2025-04-16 11:33:07,954 - dataset: MIntRec
2025-04-16 11:33:07,954 - multimodal_method: umc
2025-04-16 11:33:07,954 - method: testmethod
2025-04-16 11:33:07,954 - setting: semi_supervised
2025-04-16 11:33:07,954 - text_backbone: bert-base-uncased
2025-04-16 11:33:07,954 - seed: 0
2025-04-16 11:33:07,954 - num_workers: 16
2025-04-16 11:33:07,954 - log_id: testmethod_umc_bert-base-uncased_MIntRec_0_2025-04-16-11-32-50
2025-04-16 11:33:07,954 - gpu_id: 0
2025-04-16 11:33:07,954 - data_path: /root/autodl-tmp/home/Share/Dataset/LZH
2025-04-16 11:33:07,954 - train: True
2025-04-16 11:33:07,954 - tune: True
2025-04-16 11:33:07,954 - save_model: True
2025-04-16 11:33:07,954 - save_results: True
2025-04-16 11:33:07,954 - log_path: logs
2025-04-16 11:33:07,954 - cache_path: cache
2025-04-16 11:33:07,954 - video_data_path: video_data
2025-04-16 11:33:07,954 - audio_data_path: audio_data
2025-04-16 11:33:07,954 - video_feats_path: swin_feats.pkl
2025-04-16 11:33:07,954 - audio_feats_path: wavlm_feats.pkl
2025-04-16 11:33:07,954 - results_path: results
2025-04-16 11:33:07,954 - output_path: /root/autodl-tmp/home/lizhuohang/reaserch/EMNLP/SMC/outputs_test
2025-04-16 11:33:07,954 - model_path: models
2025-04-16 11:33:07,954 - config_file_name: testmethod_MIntRec
2025-04-16 11:33:07,955 - results_file_name: results_smc_test.csv
2025-04-16 11:33:07,955 - text_pretrained_model: uncased_L-12_H-768_A-12
2025-04-16 11:33:07,955 - pretrained_bert_model: uncased_L-12_H-768_A-12
2025-04-16 11:33:07,955 - pretrain_batch_size: 128
2025-04-16 11:33:07,955 - train_batch_size: 128
2025-04-16 11:33:07,955 - eval_batch_size: 64
2025-04-16 11:33:07,955 - test_batch_size: 64
2025-04-16 11:33:07,955 - num_pretrain_epochs: 100
2025-04-16 11:33:07,955 - num_train_epochs: 100
2025-04-16 11:33:07,955 - pretrain: [True]
2025-04-16 11:33:07,955 - aligned_method: ctc
2025-04-16 11:33:07,955 - need_aligned: False
2025-04-16 11:33:07,955 - freeze_pretrain_bert_parameters: [True]
2025-04-16 11:33:07,955 - freeze_train_bert_parameters: [True]
2025-04-16 11:33:07,955 - activation: tanh
2025-04-16 11:33:07,955 - lr_pre: [3e-05]
2025-04-16 11:33:07,955 - lr: [5e-05]
2025-04-16 11:33:07,956 - weight_decay: 0.01
2025-04-16 11:33:07,956 - feat_dim: 768
2025-04-16 11:33:07,956 - hidden_size: 768
2025-04-16 11:33:07,956 - warmup_proportion: 0.1
2025-04-16 11:33:07,956 - hidden_dropout_prob: 0.01
2025-04-16 11:33:07,956 - weight: 1.0
2025-04-16 11:33:07,956 - loss_mode: rdrop
2025-04-16 11:33:07,956 - base_dim: 256
2025-04-16 11:33:07,956 - nheads: 8
2025-04-16 11:33:07,956 - attn_dropout: 0.1
2025-04-16 11:33:07,956 - relu_dropout: 0.01
2025-04-16 11:33:07,956 - embed_dropout: 0.1
2025-04-16 11:33:07,956 - res_dropout: 0.0
2025-04-16 11:33:07,956 - attn_mask: True
2025-04-16 11:33:07,956 - encoder_layers_1: 1
2025-04-16 11:33:07,956 - fusion_act: tanh
2025-04-16 11:33:07,956 - known_cls_ratio: 0.25
2025-04-16 11:33:07,956 - labeled_ratio: 0.1
2025-04-16 11:33:07,956 - cluster_num_factor: 1.0
2025-04-16 11:33:07,956 - wait_patient: 10
2025-04-16 11:33:07,956 - pred_output_path: /root/autodl-tmp/home/lizhuohang/reaserch/EMNLP/SMC/outputs_test/testmethod_umc_MIntRec_bert-base-uncased_0
2025-04-16 11:33:07,956 - model_output_path: /root/autodl-tmp/home/lizhuohang/reaserch/EMNLP/SMC/outputs_test/testmethod_umc_MIntRec_bert-base-uncased_0/models
2025-04-16 11:33:07,956 - text_seq_len: 30
2025-04-16 11:33:07,956 - video_seq_len: 230
2025-04-16 11:33:07,956 - audio_seq_len: 480
2025-04-16 11:33:07,956 - text_feat_dim: 768
2025-04-16 11:33:07,956 - video_feat_dim: 1024
2025-04-16 11:33:07,956 - audio_feat_dim: 768
2025-04-16 11:33:07,956 - n_known_cls: 5
2025-04-16 11:33:07,957 - num_labels: 20
2025-04-16 11:33:07,957 - num_train_examples: 1334
2025-04-16 11:33:07,957 - ============================== End Params ==============================
2025-04-16 11:33:09,241 - Freeze all parameters but the last layer for efficiency
2025-04-16 11:33:09,276 - Pre-training start...
2025-04-16 11:33:09,277 - 【测试】【预训练】: 0
2025-04-16 11:33:12,845 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:33:18,308 - ***** Epoch: 1: Eval results *****
2025-04-16 11:33:18,308 -   best_score = 0
2025-04-16 11:33:18,308 -   eval_score = 17.2
2025-04-16 11:33:18,308 -   train_loss = 1.6025508642196655
2025-04-16 11:33:18,333 - 【测试】【预训练】: 1
2025-04-16 11:33:21,823 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:33:26,805 - ***** Epoch: 2: Eval results *****
2025-04-16 11:33:26,805 -   best_score = 17.2
2025-04-16 11:33:26,805 -   eval_score = 17.2
2025-04-16 11:33:26,805 -   train_loss = 1.6095370054244995
2025-04-16 11:33:26,806 - 【测试】【预训练】: 2
2025-04-16 11:33:30,357 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:33:35,339 - ***** Epoch: 3: Eval results *****
2025-04-16 11:33:35,339 -   best_score = 17.2
2025-04-16 11:33:35,339 -   eval_score = 17.2
2025-04-16 11:33:35,339 -   train_loss = 1.5996688604354858
2025-04-16 11:33:35,341 - 【测试】【预训练】: 3
2025-04-16 11:33:38,865 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:33:43,700 - ***** Epoch: 4: Eval results *****
2025-04-16 11:33:43,700 -   best_score = 17.2
2025-04-16 11:33:43,700 -   eval_score = 18.28
2025-04-16 11:33:43,700 -   train_loss = 1.5969692468643188
2025-04-16 11:33:43,726 - 【测试】【预训练】: 4
2025-04-16 11:33:47,224 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:33:52,127 - ***** Epoch: 5: Eval results *****
2025-04-16 11:33:52,128 -   best_score = 18.28
2025-04-16 11:33:52,128 -   eval_score = 18.28
2025-04-16 11:33:52,128 -   train_loss = 1.6071193218231201
2025-04-16 11:33:52,129 - 【测试】【预训练】: 5
2025-04-16 11:33:55,586 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:00,645 - ***** Epoch: 6: Eval results *****
2025-04-16 11:34:00,645 -   best_score = 18.28
2025-04-16 11:34:00,645 -   eval_score = 18.28
2025-04-16 11:34:00,645 -   train_loss = 1.6073179244995117
2025-04-16 11:34:00,646 - 【测试】【预训练】: 6
2025-04-16 11:34:04,166 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:08,977 - ***** Epoch: 7: Eval results *****
2025-04-16 11:34:08,978 -   best_score = 18.28
2025-04-16 11:34:08,978 -   eval_score = 19.35
2025-04-16 11:34:08,978 -   train_loss = 1.6012208461761475
2025-04-16 11:34:09,004 - 【测试】【预训练】: 7
2025-04-16 11:34:12,472 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:17,629 - ***** Epoch: 8: Eval results *****
2025-04-16 11:34:17,629 -   best_score = 19.35
2025-04-16 11:34:17,629 -   eval_score = 19.35
2025-04-16 11:34:17,630 -   train_loss = 1.5966414213180542
2025-04-16 11:34:17,631 - 【测试】【预训练】: 8
2025-04-16 11:34:21,164 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:26,106 - ***** Epoch: 9: Eval results *****
2025-04-16 11:34:26,106 -   best_score = 19.35
2025-04-16 11:34:26,106 -   eval_score = 18.28
2025-04-16 11:34:26,106 -   train_loss = 1.5930243730545044
2025-04-16 11:34:26,108 - 【测试】【预训练】: 9
2025-04-16 11:34:29,689 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:34,445 - ***** Epoch: 10: Eval results *****
2025-04-16 11:34:34,446 -   best_score = 19.35
2025-04-16 11:34:34,446 -   eval_score = 18.28
2025-04-16 11:34:34,446 -   train_loss = 1.587266206741333
2025-04-16 11:34:34,447 - 【测试】【预训练】: 10
2025-04-16 11:34:38,009 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:42,891 - ***** Epoch: 11: Eval results *****
2025-04-16 11:34:42,892 -   best_score = 19.35
2025-04-16 11:34:42,892 -   eval_score = 18.28
2025-04-16 11:34:42,892 -   train_loss = 1.5900065898895264
2025-04-16 11:34:42,893 - 【测试】【预训练】: 11
2025-04-16 11:34:46,423 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:51,416 - ***** Epoch: 12: Eval results *****
2025-04-16 11:34:51,416 -   best_score = 19.35
2025-04-16 11:34:51,416 -   eval_score = 18.28
2025-04-16 11:34:51,416 -   train_loss = 1.590326189994812
2025-04-16 11:34:51,418 - 【测试】【预训练】: 12
2025-04-16 11:34:54,937 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:34:59,669 - ***** Epoch: 13: Eval results *****
2025-04-16 11:34:59,669 -   best_score = 19.35
2025-04-16 11:34:59,669 -   eval_score = 18.28
2025-04-16 11:34:59,669 -   train_loss = 1.5923213958740234
2025-04-16 11:34:59,670 - 【测试】【预训练】: 13
2025-04-16 11:35:03,239 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:35:08,128 - ***** Epoch: 14: Eval results *****
2025-04-16 11:35:08,128 -   best_score = 19.35
2025-04-16 11:35:08,128 -   eval_score = 18.28
2025-04-16 11:35:08,128 -   train_loss = 1.5691261291503906
2025-04-16 11:35:08,130 - 【测试】【预训练】: 14
2025-04-16 11:35:11,706 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:35:16,728 - ***** Epoch: 15: Eval results *****
2025-04-16 11:35:16,728 -   best_score = 19.35
2025-04-16 11:35:16,728 -   eval_score = 18.28
2025-04-16 11:35:16,728 -   train_loss = 1.580739974975586
2025-04-16 11:35:16,729 - 【测试】【预训练】: 15
2025-04-16 11:35:20,255 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
2025-04-16 11:35:24,959 - ***** Epoch: 16: Eval results *****
2025-04-16 11:35:24,960 -   best_score = 19.35
2025-04-16 11:35:24,960 -   eval_score = 16.13
2025-04-16 11:35:24,960 -   train_loss = 1.5706144571304321
2025-04-16 11:35:24,961 - 【测试】【预训练】: 16
2025-04-16 11:35:28,498 - 【测试】【预训练】: tensor([0, 4, 2, 3, 4, 2, 1, 1, 3, 1, 0, 1, 4, 2, 1, 1, 0, 4, 1, 0, 1, 1, 4, 3,
        1, 1, 1, 1], device='cuda:0')
