2025-04-15 22:46:46,825 - 进入了无监督的设定中, 加载数据集
2025-04-15 22:46:46,832 - data preparation...
2025-04-15 22:46:57,442 - Number of train samples = 1779
2025-04-15 22:46:57,444 - Number of testing samples = 445
2025-04-15 22:46:57,445 - data preparation...
2025-04-15 22:47:00,069 - ============================== Params ==============================
2025-04-15 22:47:00,070 - logger_name: umc_umc_bert-base-uncased_MIntRec_0
2025-04-15 22:47:00,070 - dataset: MIntRec
2025-04-15 22:47:00,070 - multimodal_method: umc
2025-04-15 22:47:00,070 - method: umc
2025-04-15 22:47:00,070 - setting: unsupervised
2025-04-15 22:47:00,070 - text_backbone: bert-base-uncased
2025-04-15 22:47:00,070 - seed: 0
2025-04-15 22:47:00,070 - num_workers: 16
2025-04-15 22:47:00,070 - log_id: umc_umc_bert-base-uncased_MIntRec_0_2025-04-15-22-46-46
2025-04-15 22:47:00,070 - gpu_id: 0
2025-04-15 22:47:00,070 - data_path: /root/autodl-tmp/home/Share/Dataset/LZH
2025-04-15 22:47:00,070 - train: True
2025-04-15 22:47:00,070 - tune: True
2025-04-15 22:47:00,070 - save_model: True
2025-04-15 22:47:00,070 - save_results: True
2025-04-15 22:47:00,070 - log_path: logs
2025-04-15 22:47:00,070 - cache_path: cache
2025-04-15 22:47:00,070 - video_data_path: video_data
2025-04-15 22:47:00,070 - audio_data_path: audio_data
2025-04-15 22:47:00,070 - video_feats_path: swin_feats.pkl
2025-04-15 22:47:00,070 - audio_feats_path: wavlm_feats.pkl
2025-04-15 22:47:00,070 - results_path: results
2025-04-15 22:47:00,070 - output_path: /root/autodl-tmp/home/lizhuohang/reaserch/EMNLP/SMC/outputs_test/MIntRec
2025-04-15 22:47:00,070 - model_path: models
2025-04-15 22:47:00,070 - config_file_name: umc_MIntRec
2025-04-15 22:47:00,071 - results_file_name: results_umc.csv
2025-04-15 22:47:00,071 - text_pretrained_model: uncased_L-12_H-768_A-12
2025-04-15 22:47:00,071 - pretrained_bert_model: uncased_L-12_H-768_A-12
2025-04-15 22:47:00,071 - pretrain_batch_size: 128
2025-04-15 22:47:00,071 - train_batch_size: 128
2025-04-15 22:47:00,071 - eval_batch_size: 128
2025-04-15 22:47:00,071 - test_batch_size: 128
2025-04-15 22:47:00,071 - num_pretrain_epochs: 100
2025-04-15 22:47:00,071 - num_train_epochs: 100
2025-04-15 22:47:00,071 - pretrain: [True]
2025-04-15 22:47:00,071 - aligned_method: ctc
2025-04-15 22:47:00,071 - need_aligned: False
2025-04-15 22:47:00,071 - freeze_pretrain_bert_parameters: [True]
2025-04-15 22:47:00,071 - freeze_train_bert_parameters: [True]
2025-04-15 22:47:00,071 - pretrain_temperature: [0.1]
2025-04-15 22:47:00,071 - train_temperature_sup: [0.5, 1, 2, 4, 6, 8]
2025-04-15 22:47:00,072 - train_temperature_unsup: [0.5, 1, 2, 4, 6, 8]
2025-04-15 22:47:00,072 - activation: tanh
2025-04-15 22:47:00,072 - lr_pre: 1e-05
2025-04-15 22:47:00,072 - lr: [0.0001]
2025-04-15 22:47:00,072 - delta: [0.05]
2025-04-15 22:47:00,072 - thres: [0.1]
2025-04-15 22:47:00,072 - topk: [5]
2025-04-15 22:47:00,072 - weight_decay: 0.01
2025-04-15 22:47:00,072 - feat_dim: 768
2025-04-15 22:47:00,072 - hidden_size: 768
2025-04-15 22:47:00,072 - grad_clip: -1.0
2025-04-15 22:47:00,072 - warmup_proportion: 0.5
2025-04-15 22:47:00,072 - hidden_dropout_prob: 0.1
2025-04-15 22:47:00,072 - weight: 1.0
2025-04-15 22:47:00,072 - loss_mode: rdrop
2025-04-15 22:47:00,072 - base_dim: 256
2025-04-15 22:47:00,072 - nheads: 8
2025-04-15 22:47:00,072 - attn_dropout: 0.1
2025-04-15 22:47:00,072 - relu_dropout: 0.1
2025-04-15 22:47:00,072 - embed_dropout: 0.01
2025-04-15 22:47:00,072 - res_dropout: 0.0
2025-04-15 22:47:00,072 - attn_mask: True
2025-04-15 22:47:00,072 - encoder_layers_1: 1
2025-04-15 22:47:00,072 - fusion_act: tanh
2025-04-15 22:47:00,072 - pred_output_path: /root/autodl-tmp/home/lizhuohang/reaserch/EMNLP/SMC/outputs_test/MIntRec/umc_umc_MIntRec_bert-base-uncased_0
2025-04-15 22:47:00,072 - model_output_path: /root/autodl-tmp/home/lizhuohang/reaserch/EMNLP/SMC/outputs_test/MIntRec/umc_umc_MIntRec_bert-base-uncased_0/models
2025-04-15 22:47:00,072 - text_seq_len: 30
2025-04-15 22:47:00,072 - video_seq_len: 230
2025-04-15 22:47:00,073 - audio_seq_len: 480
2025-04-15 22:47:00,073 - text_feat_dim: 768
2025-04-15 22:47:00,073 - video_feat_dim: 1024
2025-04-15 22:47:00,073 - audio_feat_dim: 768
2025-04-15 22:47:00,073 - num_train_examples: 1779
2025-04-15 22:47:00,073 - ============================== End Params ==============================
2025-04-15 22:47:01,429 - Freeze all parameters but the last layer for efficiency
2025-04-15 22:47:01,470 - Pre-training start...
2025-04-15 22:47:32,242 - ***** Epoch: 1: Eval results *****
2025-04-15 22:47:32,242 -   train_loss = 5.9495507308415005
2025-04-15 22:47:57,198 - ***** Epoch: 2: Eval results *****
2025-04-15 22:47:57,199 -   train_loss = 5.955358266830444
2025-04-15 22:48:23,515 - ***** Epoch: 3: Eval results *****
2025-04-15 22:48:23,516 -   train_loss = 5.943988800048828
2025-04-15 22:48:53,290 - ***** Epoch: 4: Eval results *****
2025-04-15 22:48:53,290 -   train_loss = 5.944168635777065
2025-04-15 22:49:20,173 - ***** Epoch: 5: Eval results *****
2025-04-15 22:49:20,174 -   train_loss = 5.940595729010446
2025-04-15 22:49:45,417 - ***** Epoch: 6: Eval results *****
2025-04-15 22:49:45,418 -   train_loss = 5.940682990210397
2025-04-15 22:50:13,050 - ***** Epoch: 7: Eval results *****
2025-04-15 22:50:13,050 -   train_loss = 5.9418957233428955
2025-04-15 22:50:43,300 - ***** Epoch: 8: Eval results *****
2025-04-15 22:50:43,301 -   train_loss = 5.9308066708700995
2025-04-15 22:51:17,559 - ***** Epoch: 9: Eval results *****
2025-04-15 22:51:17,560 -   train_loss = 5.93429034096854
2025-04-15 22:51:44,608 - ***** Epoch: 10: Eval results *****
2025-04-15 22:51:44,608 -   train_loss = 5.920668704169137
2025-04-15 22:52:10,473 - ***** Epoch: 11: Eval results *****
2025-04-15 22:52:10,473 -   train_loss = 5.918321779796055
2025-04-15 22:52:37,667 - ***** Epoch: 12: Eval results *****
2025-04-15 22:52:37,667 -   train_loss = 5.898892607007708
2025-04-15 22:53:05,706 - ***** Epoch: 13: Eval results *****
2025-04-15 22:53:05,706 -   train_loss = 5.892127922603062
2025-04-15 22:53:35,898 - ***** Epoch: 14: Eval results *****
2025-04-15 22:53:35,899 -   train_loss = 5.8695346627916605
2025-04-15 22:54:02,904 - ***** Epoch: 15: Eval results *****
2025-04-15 22:54:02,904 -   train_loss = 5.848584038870675
2025-04-15 22:54:30,537 - ***** Epoch: 16: Eval results *****
2025-04-15 22:54:30,537 -   train_loss = 5.81001707485744
2025-04-15 22:55:01,007 - ***** Epoch: 17: Eval results *****
2025-04-15 22:55:01,008 -   train_loss = 5.734688179833548
2025-04-15 22:55:29,598 - ***** Epoch: 18: Eval results *****
2025-04-15 22:55:29,599 -   train_loss = 5.622323717389788
2025-04-15 22:56:00,047 - ***** Epoch: 19: Eval results *****
2025-04-15 22:56:00,048 -   train_loss = 5.466900723321097
2025-04-15 22:56:28,232 - ***** Epoch: 20: Eval results *****
2025-04-15 22:56:28,232 -   train_loss = 5.255555221012661
2025-04-15 22:56:59,609 - ***** Epoch: 21: Eval results *****
2025-04-15 22:56:59,609 -   train_loss = 5.041454315185547
2025-04-15 22:57:27,429 - ***** Epoch: 22: Eval results *****
2025-04-15 22:57:27,429 -   train_loss = 4.783291442053659
2025-04-15 22:57:58,609 - ***** Epoch: 23: Eval results *****
2025-04-15 22:57:58,609 -   train_loss = 4.559213263647897
2025-04-15 22:58:28,206 - ***** Epoch: 24: Eval results *****
2025-04-15 22:58:28,206 -   train_loss = 4.31596793447222
2025-04-15 22:58:54,657 - ***** Epoch: 25: Eval results *****
2025-04-15 22:58:54,657 -   train_loss = 4.116786292621067
2025-04-15 22:59:24,254 - ***** Epoch: 26: Eval results *****
2025-04-15 22:59:24,255 -   train_loss = 3.9324608019420078
2025-04-15 22:59:58,160 - ***** Epoch: 27: Eval results *****
2025-04-15 22:59:58,160 -   train_loss = 3.748886159488133
2025-04-15 23:00:28,335 - ***** Epoch: 28: Eval results *****
2025-04-15 23:00:28,335 -   train_loss = 3.5472201108932495
2025-04-15 23:00:58,209 - ***** Epoch: 29: Eval results *****
2025-04-15 23:00:58,209 -   train_loss = 3.391283461025783
2025-04-15 23:01:26,356 - ***** Epoch: 30: Eval results *****
2025-04-15 23:01:26,356 -   train_loss = 3.243634053639003
2025-04-15 23:01:54,873 - ***** Epoch: 31: Eval results *****
2025-04-15 23:01:54,874 -   train_loss = 3.092668890953064
2025-04-15 23:02:23,006 - ***** Epoch: 32: Eval results *****
2025-04-15 23:02:23,007 -   train_loss = 2.9618915149143765
2025-04-15 23:02:51,596 - ***** Epoch: 33: Eval results *****
2025-04-15 23:02:51,597 -   train_loss = 2.831699558666774
2025-04-15 23:03:23,803 - ***** Epoch: 34: Eval results *****
2025-04-15 23:03:23,804 -   train_loss = 2.7434243815285817
2025-04-15 23:03:50,521 - ***** Epoch: 35: Eval results *****
2025-04-15 23:03:50,521 -   train_loss = 2.6528412955147878
2025-04-15 23:04:25,277 - ***** Epoch: 36: Eval results *****
2025-04-15 23:04:25,278 -   train_loss = 2.564497777393886
2025-04-15 23:04:54,860 - ***** Epoch: 37: Eval results *****
2025-04-15 23:04:54,860 -   train_loss = 2.462603007044111
2025-04-15 23:05:21,414 - ***** Epoch: 38: Eval results *****
2025-04-15 23:05:21,414 -   train_loss = 2.385812418801444
2025-04-15 23:05:49,245 - ***** Epoch: 39: Eval results *****
2025-04-15 23:05:49,246 -   train_loss = 2.3337046248572215
2025-04-15 23:06:16,705 - ***** Epoch: 40: Eval results *****
2025-04-15 23:06:16,706 -   train_loss = 2.270782862390791
2025-04-15 23:06:45,998 - ***** Epoch: 41: Eval results *****
2025-04-15 23:06:45,998 -   train_loss = 2.2209890569959367
2025-04-15 23:07:16,334 - ***** Epoch: 42: Eval results *****
2025-04-15 23:07:16,335 -   train_loss = 2.179529002734593
2025-04-15 23:07:44,798 - ***** Epoch: 43: Eval results *****
2025-04-15 23:07:44,798 -   train_loss = 2.1140255076544627
2025-04-15 23:08:14,849 - ***** Epoch: 44: Eval results *****
2025-04-15 23:08:14,849 -   train_loss = 2.069200473172324
2025-04-15 23:08:40,708 - ***** Epoch: 45: Eval results *****
2025-04-15 23:08:40,709 -   train_loss = 2.0328834567751204
2025-04-15 23:09:07,170 - ***** Epoch: 46: Eval results *****
2025-04-15 23:09:07,171 -   train_loss = 1.9813657062394279
2025-04-15 23:09:37,910 - ***** Epoch: 47: Eval results *****
2025-04-15 23:09:37,910 -   train_loss = 1.950800963810512
2025-04-15 23:10:07,698 - ***** Epoch: 48: Eval results *****
2025-04-15 23:10:07,698 -   train_loss = 1.9075575470924377
2025-04-15 23:10:32,711 - ***** Epoch: 49: Eval results *****
2025-04-15 23:10:32,712 -   train_loss = 1.8768897312028068
2025-04-15 23:11:01,604 - ***** Epoch: 50: Eval results *****
2025-04-15 23:11:01,604 -   train_loss = 1.834214985370636
2025-04-15 23:11:31,313 - ***** Epoch: 51: Eval results *****
2025-04-15 23:11:31,314 -   train_loss = 1.8276593855449133
2025-04-15 23:11:58,670 - ***** Epoch: 52: Eval results *****
2025-04-15 23:11:58,670 -   train_loss = 1.787291944026947
2025-04-15 23:12:27,684 - ***** Epoch: 53: Eval results *****
2025-04-15 23:12:27,684 -   train_loss = 1.7758225543158395
2025-04-15 23:12:57,407 - ***** Epoch: 54: Eval results *****
2025-04-15 23:12:57,408 -   train_loss = 1.767319645200457
2025-04-15 23:13:24,598 - ***** Epoch: 55: Eval results *****
2025-04-15 23:13:24,598 -   train_loss = 1.7312930226325989
2025-04-15 23:13:55,698 - ***** Epoch: 56: Eval results *****
2025-04-15 23:13:55,698 -   train_loss = 1.7044147849082947
2025-04-15 23:14:26,941 - ***** Epoch: 57: Eval results *****
2025-04-15 23:14:26,941 -   train_loss = 1.6791687948363168
2025-04-15 23:14:54,898 - ***** Epoch: 58: Eval results *****
2025-04-15 23:14:54,898 -   train_loss = 1.6799958774021693
2025-04-15 23:15:26,310 - ***** Epoch: 59: Eval results *****
2025-04-15 23:15:26,311 -   train_loss = 1.6512435674667358
2025-04-15 23:15:58,340 - ***** Epoch: 60: Eval results *****
2025-04-15 23:15:58,341 -   train_loss = 1.6386903354099818
2025-04-15 23:16:32,500 - ***** Epoch: 61: Eval results *****
2025-04-15 23:16:32,500 -   train_loss = 1.6356177159718104
2025-04-15 23:17:02,412 - ***** Epoch: 62: Eval results *****
2025-04-15 23:17:02,412 -   train_loss = 1.6208768827574593
2025-04-15 23:17:30,210 - ***** Epoch: 63: Eval results *****
2025-04-15 23:17:30,211 -   train_loss = 1.6168820772852217
2025-04-15 23:18:02,812 - ***** Epoch: 64: Eval results *****
2025-04-15 23:18:02,813 -   train_loss = 1.5829995785440718
2025-04-15 23:18:33,293 - ***** Epoch: 65: Eval results *****
2025-04-15 23:18:33,293 -   train_loss = 1.592242649623326
2025-04-15 23:19:01,698 - ***** Epoch: 66: Eval results *****
2025-04-15 23:19:01,698 -   train_loss = 1.5768452286720276
2025-04-15 23:19:30,006 - ***** Epoch: 67: Eval results *****
2025-04-15 23:19:30,006 -   train_loss = 1.5528621673583984
2025-04-15 23:19:59,081 - ***** Epoch: 68: Eval results *****
2025-04-15 23:19:59,081 -   train_loss = 1.5513639450073242
2025-04-15 23:20:29,409 - ***** Epoch: 69: Eval results *****
2025-04-15 23:20:29,409 -   train_loss = 1.5434449400220598
2025-04-15 23:21:04,304 - ***** Epoch: 70: Eval results *****
2025-04-15 23:21:04,304 -   train_loss = 1.551415775503431
2025-04-15 23:21:34,856 - ***** Epoch: 71: Eval results *****
2025-04-15 23:21:34,856 -   train_loss = 1.5383132781301225
2025-04-15 23:22:05,507 - ***** Epoch: 72: Eval results *****
2025-04-15 23:22:05,507 -   train_loss = 1.549813142844609
2025-04-15 23:22:35,233 - ***** Epoch: 73: Eval results *****
2025-04-15 23:22:35,234 -   train_loss = 1.5364599823951721
2025-04-15 23:23:06,197 - ***** Epoch: 74: Eval results *****
2025-04-15 23:23:06,197 -   train_loss = 1.5309514318193709
2025-04-15 23:23:33,709 - ***** Epoch: 75: Eval results *****
2025-04-15 23:23:33,709 -   train_loss = 1.5277042559215002
2025-04-15 23:24:00,449 - ***** Epoch: 76: Eval results *****
2025-04-15 23:24:00,450 -   train_loss = 1.5174924646105086
2025-04-15 23:24:32,398 - ***** Epoch: 77: Eval results *****
2025-04-15 23:24:32,399 -   train_loss = 1.5011286990983146
2025-04-15 23:25:09,907 - ***** Epoch: 78: Eval results *****
2025-04-15 23:25:09,907 -   train_loss = 1.5036937083516801
2025-04-15 23:25:41,941 - ***** Epoch: 79: Eval results *****
2025-04-15 23:25:41,942 -   train_loss = 1.501652215208326
2025-04-15 23:26:13,701 - ***** Epoch: 80: Eval results *****
2025-04-15 23:26:13,701 -   train_loss = 1.4958985107285636
2025-04-15 23:26:44,315 - ***** Epoch: 81: Eval results *****
2025-04-15 23:26:44,315 -   train_loss = 1.4978841032300676
2025-04-15 23:27:15,710 - ***** Epoch: 82: Eval results *****
2025-04-15 23:27:15,710 -   train_loss = 1.4916800601141793
2025-04-15 23:27:46,848 - ***** Epoch: 83: Eval results *****
2025-04-15 23:27:46,849 -   train_loss = 1.5059868693351746
2025-04-15 23:28:21,210 - ***** Epoch: 84: Eval results *****
2025-04-15 23:28:21,211 -   train_loss = 1.4844991735049657
2025-04-15 23:28:52,004 - ***** Epoch: 85: Eval results *****
2025-04-15 23:28:52,004 -   train_loss = 1.4872920768601554
2025-04-15 23:29:21,572 - ***** Epoch: 86: Eval results *****
2025-04-15 23:29:21,573 -   train_loss = 1.4864764894757951
2025-04-15 23:29:51,350 - ***** Epoch: 87: Eval results *****
2025-04-15 23:29:51,350 -   train_loss = 1.4792463268552507
2025-04-15 23:30:15,950 - ***** Epoch: 88: Eval results *****
2025-04-15 23:30:15,951 -   train_loss = 1.4761233414922441
2025-04-15 23:30:43,999 - ***** Epoch: 89: Eval results *****
2025-04-15 23:30:44,001 -   train_loss = 1.4691850117274694
2025-04-15 23:31:08,613 - ***** Epoch: 90: Eval results *****
2025-04-15 23:31:08,614 -   train_loss = 1.4841335245541163
2025-04-15 23:31:35,947 - ***** Epoch: 91: Eval results *****
2025-04-15 23:31:35,947 -   train_loss = 1.4695379904338293
2025-04-15 23:32:04,008 - ***** Epoch: 92: Eval results *****
2025-04-15 23:32:04,008 -   train_loss = 1.4748034392084395
2025-04-15 23:32:36,402 - ***** Epoch: 93: Eval results *****
2025-04-15 23:32:36,403 -   train_loss = 1.4745393565722875
2025-04-15 23:33:00,457 - ***** Epoch: 94: Eval results *****
2025-04-15 23:33:00,457 -   train_loss = 1.4733967695917403
2025-04-15 23:33:25,045 - ***** Epoch: 95: Eval results *****
2025-04-15 23:33:25,045 -   train_loss = 1.4720470990453447
2025-04-15 23:33:46,616 - ***** Epoch: 96: Eval results *****
2025-04-15 23:33:46,616 -   train_loss = 1.4663529736655099
2025-04-15 23:34:11,876 - ***** Epoch: 97: Eval results *****
2025-04-15 23:34:11,876 -   train_loss = 1.4636993663651603
2025-04-15 23:34:34,822 - ***** Epoch: 98: Eval results *****
2025-04-15 23:34:34,822 -   train_loss = 1.4828499470438277
2025-04-15 23:35:01,630 - ***** Epoch: 99: Eval results *****
2025-04-15 23:35:01,630 -   train_loss = 1.4689759271485465
2025-04-15 23:35:25,508 - ***** Epoch: 100: Eval results *****
2025-04-15 23:35:25,509 -   train_loss = 1.4735297390392847
2025-04-15 23:35:26,136 - Pre-training finished...
